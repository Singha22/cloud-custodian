{
    "status_code": 200,
    "data": {
        "TemplateBody": "{\n  \"Resources\": {\n    \"InputSQSDeadLetterQueueF061FA30\": {\n      \"Type\": \"AWS::SQS::Queue\",\n      \"Properties\": {\n        \"MessageRetentionPeriod\": 3600\n      },\n      \"UpdateReplacePolicy\": \"Delete\",\n      \"DeletionPolicy\": \"Delete\",\n      \"Metadata\": {\n        \"aws:cdk:path\": \"CloudActionModulePoc3Stack/InputSQSDeadLetterQueue/Resource\"\n      }\n    },\n    \"InputSQSQueue23D0B3DB\": {\n      \"Type\": \"AWS::SQS::Queue\",\n      \"Properties\": {\n        \"RedrivePolicy\": {\n          \"deadLetterTargetArn\": {\n            \"Fn::GetAtt\": [\n              \"InputSQSDeadLetterQueueF061FA30\",\n              \"Arn\"\n            ]\n          },\n          \"maxReceiveCount\": 1\n        }\n      },\n      \"UpdateReplacePolicy\": \"Delete\",\n      \"DeletionPolicy\": \"Delete\",\n      \"Metadata\": {\n        \"aws:cdk:path\": \"CloudActionModulePoc3Stack/InputSQSQueue/Resource\"\n      }\n    },\n    \"IngestionLambdaExecutionRole9029C4EB\": {\n      \"Type\": \"AWS::IAM::Role\",\n      \"Properties\": {\n        \"AssumeRolePolicyDocument\": {\n          \"Statement\": [\n            {\n              \"Action\": \"sts:AssumeRole\",\n              \"Effect\": \"Allow\",\n              \"Principal\": {\n                \"Service\": \"lambda.amazonaws.com\"\n              }\n            }\n          ],\n          \"Version\": \"2012-10-17\"\n        },\n        \"ManagedPolicyArns\": [\n          {\n            \"Fn::Join\": [\n              \"\",\n              [\n                \"arn:\",\n                {\n                  \"Ref\": \"AWS::Partition\"\n                },\n                \":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole\"\n              ]\n            ]\n          }\n        ]\n      },\n      \"Metadata\": {\n        \"aws:cdk:path\": \"CloudActionModulePoc3Stack/IngestionLambdaExecutionRole/Resource\"\n      }\n    },\n    \"IngestionLambdaExecutionRoleDefaultPolicy71B98685\": {\n      \"Type\": \"AWS::IAM::Policy\",\n      \"Properties\": {\n        \"PolicyDocument\": {\n          \"Statement\": [\n            {\n              \"Action\": [\n                \"sqs:ChangeMessageVisibility\",\n                \"sqs:DeleteMessage\",\n                \"sqs:GetQueueAttributes\",\n                \"sqs:GetQueueUrl\",\n                \"sqs:ReceiveMessage\"\n              ],\n              \"Effect\": \"Allow\",\n              \"Resource\": {\n                \"Fn::GetAtt\": [\n                  \"InputSQSQueue23D0B3DB\",\n                  \"Arn\"\n                ]\n              }\n            }\n          ],\n          \"Version\": \"2012-10-17\"\n        },\n        \"PolicyName\": \"IngestionLambdaExecutionRoleDefaultPolicy71B98685\",\n        \"Roles\": [\n          {\n            \"Ref\": \"IngestionLambdaExecutionRole9029C4EB\"\n          }\n        ]\n      },\n      \"Metadata\": {\n        \"aws:cdk:path\": \"CloudActionModulePoc3Stack/IngestionLambdaExecutionRole/DefaultPolicy/Resource\"\n      }\n    },\n    \"IngestionLambdaPolicy4A8BF0F4\": {\n      \"Type\": \"AWS::IAM::Policy\",\n      \"Properties\": {\n        \"PolicyDocument\": {\n          \"Statement\": [\n            {\n              \"Action\": [\n                \"sqs:ChangeMessageVisibility\",\n                \"sqs:DeleteMessage\",\n                \"sqs:Get*\",\n                \"sqs:ReceiveMessage\"\n              ],\n              \"Effect\": \"Allow\",\n              \"Resource\": {\n                \"Fn::GetAtt\": [\n                  \"InputSQSQueue23D0B3DB\",\n                  \"Arn\"\n                ]\n              }\n            },\n            {\n              \"Action\": [\n                \"securityhub:BatchImportFindings\",\n                \"securityhub:DescribeHub\"\n              ],\n              \"Effect\": \"Allow\",\n              \"Resource\": \"*\"\n            }\n          ],\n          \"Version\": \"2012-10-17\"\n        },\n        \"PolicyName\": \"IngestionLambdaPolicy4A8BF0F4\",\n        \"Roles\": [\n          {\n            \"Ref\": \"IngestionLambdaExecutionRole9029C4EB\"\n          }\n        ]\n      },\n      \"Metadata\": {\n        \"aws:cdk:path\": \"CloudActionModulePoc3Stack/IngestionLambdaPolicy/Resource\"\n      }\n    },\n    \"IngestionLambdaEF25F265\": {\n      \"Type\": \"AWS::Lambda::Function\",\n      \"Properties\": {\n        \"Code\": {\n          \"S3Bucket\": {\n            \"Fn::Sub\": \"cdk-hnb659fds-assets-${AWS::AccountId}-${AWS::Region}\"\n          },\n          \"S3Key\": \"906cdde59aa12124f63f55d746e4b4e4da30103fbd5087292563916e1a69f5f0.zip\"\n        },\n        \"Role\": {\n          \"Fn::GetAtt\": [\n            \"IngestionLambdaExecutionRole9029C4EB\",\n            \"Arn\"\n          ]\n        },\n        \"Handler\": \"ingestion.lambda_handler\",\n        \"Runtime\": \"python3.9\"\n      },\n      \"DependsOn\": [\n        \"IngestionLambdaExecutionRoleDefaultPolicy71B98685\",\n        \"IngestionLambdaExecutionRole9029C4EB\"\n      ],\n      \"Metadata\": {\n        \"aws:cdk:path\": \"CloudActionModulePoc3Stack/IngestionLambda/Resource\",\n        \"aws:asset:path\": \"asset.906cdde59aa12124f63f55d746e4b4e4da30103fbd5087292563916e1a69f5f0\",\n        \"aws:asset:is-bundled\": false,\n        \"aws:asset:property\": \"Code\"\n      }\n    },\n    \"IngestionLambdaLogRetention3126F7CA\": {\n      \"Type\": \"Custom::LogRetention\",\n      \"Properties\": {\n        \"ServiceToken\": {\n          \"Fn::GetAtt\": [\n            \"LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8aFD4BFC8A\",\n            \"Arn\"\n          ]\n        },\n        \"LogGroupName\": {\n          \"Fn::Join\": [\n            \"\",\n            [\n              \"/aws/lambda/\",\n              {\n                \"Ref\": \"IngestionLambdaEF25F265\"\n              }\n            ]\n          ]\n        },\n        \"RetentionInDays\": 7\n      },\n      \"Metadata\": {\n        \"aws:cdk:path\": \"CloudActionModulePoc3Stack/IngestionLambda/LogRetention/Resource\"\n      }\n    },\n    \"IngestionLambdaSqsEventSourceCloudActionModulePoc3StackInputSQSQueue4133A2AB1F2CE21E\": {\n      \"Type\": \"AWS::Lambda::EventSourceMapping\",\n      \"Properties\": {\n        \"FunctionName\": {\n          \"Ref\": \"IngestionLambdaEF25F265\"\n        },\n        \"EventSourceArn\": {\n          \"Fn::GetAtt\": [\n            \"InputSQSQueue23D0B3DB\",\n            \"Arn\"\n          ]\n        }\n      },\n      \"Metadata\": {\n        \"aws:cdk:path\": \"CloudActionModulePoc3Stack/IngestionLambda/SqsEventSource:CloudActionModulePoc3StackInputSQSQueue4133A2AB/Resource\"\n      }\n    },\n    \"LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8aServiceRole9741ECFB\": {\n      \"Type\": \"AWS::IAM::Role\",\n      \"Properties\": {\n        \"AssumeRolePolicyDocument\": {\n          \"Statement\": [\n            {\n              \"Action\": \"sts:AssumeRole\",\n              \"Effect\": \"Allow\",\n              \"Principal\": {\n                \"Service\": \"lambda.amazonaws.com\"\n              }\n            }\n          ],\n          \"Version\": \"2012-10-17\"\n        },\n        \"ManagedPolicyArns\": [\n          {\n            \"Fn::Join\": [\n              \"\",\n              [\n                \"arn:\",\n                {\n                  \"Ref\": \"AWS::Partition\"\n                },\n                \":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole\"\n              ]\n            ]\n          }\n        ]\n      },\n      \"Metadata\": {\n        \"aws:cdk:path\": \"CloudActionModulePoc3Stack/LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8a/ServiceRole/Resource\"\n      }\n    },\n    \"LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8aServiceRoleDefaultPolicyADDA7DEB\": {\n      \"Type\": \"AWS::IAM::Policy\",\n      \"Properties\": {\n        \"PolicyDocument\": {\n          \"Statement\": [\n            {\n              \"Action\": [\n                \"logs:DeleteRetentionPolicy\",\n                \"logs:PutRetentionPolicy\"\n              ],\n              \"Effect\": \"Allow\",\n              \"Resource\": \"*\"\n            }\n          ],\n          \"Version\": \"2012-10-17\"\n        },\n        \"PolicyName\": \"LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8aServiceRoleDefaultPolicyADDA7DEB\",\n        \"Roles\": [\n          {\n            \"Ref\": \"LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8aServiceRole9741ECFB\"\n          }\n        ]\n      },\n      \"Metadata\": {\n        \"aws:cdk:path\": \"CloudActionModulePoc3Stack/LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8a/ServiceRole/DefaultPolicy/Resource\"\n      }\n    },\n    \"LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8aFD4BFC8A\": {\n      \"Type\": \"AWS::Lambda::Function\",\n      \"Properties\": {\n        \"Handler\": \"index.handler\",\n        \"Runtime\": \"nodejs14.x\",\n        \"Code\": {\n          \"S3Bucket\": {\n            \"Fn::Sub\": \"cdk-hnb659fds-assets-${AWS::AccountId}-${AWS::Region}\"\n          },\n          \"S3Key\": \"558dc75fbdc793c8e2f64f85d2d7ed2cb820c727ec7e9b08666ad1af0103992e.zip\"\n        },\n        \"Role\": {\n          \"Fn::GetAtt\": [\n            \"LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8aServiceRole9741ECFB\",\n            \"Arn\"\n          ]\n        }\n      },\n      \"DependsOn\": [\n        \"LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8aServiceRoleDefaultPolicyADDA7DEB\",\n        \"LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8aServiceRole9741ECFB\"\n      ],\n      \"Metadata\": {\n        \"aws:cdk:path\": \"CloudActionModulePoc3Stack/LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8a/Resource\",\n        \"aws:asset:path\": \"asset.558dc75fbdc793c8e2f64f85d2d7ed2cb820c727ec7e9b08666ad1af0103992e\",\n        \"aws:asset:is-bundled\": false,\n        \"aws:asset:property\": \"Code\"\n      }\n    },\n    \"LambdaRemediationLambdaServiceRole5BCEEFBD\": {\n      \"Type\": \"AWS::IAM::Role\",\n      \"Properties\": {\n        \"AssumeRolePolicyDocument\": {\n          \"Statement\": [\n            {\n              \"Action\": \"sts:AssumeRole\",\n              \"Effect\": \"Allow\",\n              \"Principal\": {\n                \"Service\": \"lambda.amazonaws.com\"\n              }\n            }\n          ],\n          \"Version\": \"2012-10-17\"\n        },\n        \"ManagedPolicyArns\": [\n          {\n            \"Fn::Join\": [\n              \"\",\n              [\n                \"arn:\",\n                {\n                  \"Ref\": \"AWS::Partition\"\n                },\n                \":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole\"\n              ]\n            ]\n          }\n        ]\n      },\n      \"Metadata\": {\n        \"aws:cdk:path\": \"CloudActionModulePoc3Stack/LambdaRemediationLambda/ServiceRole/Resource\"\n      }\n    },\n    \"LambdaRemediationLambdaBB234D1C\": {\n      \"Type\": \"AWS::Lambda::Function\",\n      \"Properties\": {\n        \"Code\": {\n          \"S3Bucket\": {\n            \"Fn::Sub\": \"cdk-hnb659fds-assets-${AWS::AccountId}-${AWS::Region}\"\n          },\n          \"S3Key\": \"906cdde59aa12124f63f55d746e4b4e4da30103fbd5087292563916e1a69f5f0.zip\"\n        },\n        \"Role\": {\n          \"Fn::GetAtt\": [\n            \"LambdaRemediationLambdaServiceRole5BCEEFBD\",\n            \"Arn\"\n          ]\n        },\n        \"Handler\": \"remediation.lambda_handler\",\n        \"Runtime\": \"python3.9\"\n      },\n      \"DependsOn\": [\n        \"LambdaRemediationLambdaServiceRole5BCEEFBD\"\n      ],\n      \"Metadata\": {\n        \"aws:cdk:path\": \"CloudActionModulePoc3Stack/LambdaRemediationLambda/Resource\",\n        \"aws:asset:path\": \"asset.906cdde59aa12124f63f55d746e4b4e4da30103fbd5087292563916e1a69f5f0\",\n        \"aws:asset:is-bundled\": false,\n        \"aws:asset:property\": \"Code\"\n      }\n    },\n    \"LambdaRemediationLambdaLogRetention0C9C070D\": {\n      \"Type\": \"Custom::LogRetention\",\n      \"Properties\": {\n        \"ServiceToken\": {\n          \"Fn::GetAtt\": [\n            \"LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8aFD4BFC8A\",\n            \"Arn\"\n          ]\n        },\n        \"LogGroupName\": {\n          \"Fn::Join\": [\n            \"\",\n            [\n              \"/aws/lambda/\",\n              {\n                \"Ref\": \"LambdaRemediationLambdaBB234D1C\"\n              }\n            ]\n          ]\n        },\n        \"RetentionInDays\": 7\n      },\n      \"Metadata\": {\n        \"aws:cdk:path\": \"CloudActionModulePoc3Stack/LambdaRemediationLambda/LogRetention/Resource\"\n      }\n    },\n    \"CDKMetadata\": {\n      \"Type\": \"AWS::CDK::Metadata\",\n      \"Properties\": {\n        \"Analytics\": \"v2:deflate64:H4sIAAAAAAAA/2VPSw6CMBA9C/syCqxcqtGVJogHMLWMWCktOq3GNNzdUowbV+87L5kcsgXME/6iVNRtquQZ/NFy0bJgnTzdCfzBoUO2vuhIBiZ5B74yKnoRS6OkeI9yYgNTvDvXHPzWaWGl0WP245snans07iFwz/te6maM/92BUXHiRGgJliMEDSsnWrQrTsiUaQh2pqnQhtOwPLBYCw8039EKKS6yHwnm2uhaTv3yba9GzwpYQJYnN5Iyfbiw1SFUE34AbnpQViIBAAA=\"\n      },\n      \"Metadata\": {\n        \"aws:cdk:path\": \"CloudActionModulePoc3Stack/CDKMetadata/Default\"\n      },\n      \"Condition\": \"CDKMetadataAvailable\"\n    }\n  },\n  \"Conditions\": {\n    \"CDKMetadataAvailable\": {\n      \"Fn::Or\": [\n        {\n          \"Fn::Or\": [\n            {\n              \"Fn::Equals\": [\n                {\n                  \"Ref\": \"AWS::Region\"\n                },\n                \"af-south-1\"\n              ]\n            },\n            {\n              \"Fn::Equals\": [\n                {\n                  \"Ref\": \"AWS::Region\"\n                },\n                \"ap-east-1\"\n              ]\n            },\n            {\n              \"Fn::Equals\": [\n                {\n                  \"Ref\": \"AWS::Region\"\n                },\n                \"ap-northeast-1\"\n              ]\n            },\n            {\n              \"Fn::Equals\": [\n                {\n                  \"Ref\": \"AWS::Region\"\n                },\n                \"ap-northeast-2\"\n              ]\n            },\n            {\n              \"Fn::Equals\": [\n                {\n                  \"Ref\": \"AWS::Region\"\n                },\n                \"ap-south-1\"\n              ]\n            },\n            {\n              \"Fn::Equals\": [\n                {\n                  \"Ref\": \"AWS::Region\"\n                },\n                \"ap-southeast-1\"\n              ]\n            },\n            {\n              \"Fn::Equals\": [\n                {\n                  \"Ref\": \"AWS::Region\"\n                },\n                \"ap-southeast-2\"\n              ]\n            },\n            {\n              \"Fn::Equals\": [\n                {\n                  \"Ref\": \"AWS::Region\"\n                },\n                \"ca-central-1\"\n              ]\n            },\n            {\n              \"Fn::Equals\": [\n                {\n                  \"Ref\": \"AWS::Region\"\n                },\n                \"cn-north-1\"\n              ]\n            },\n            {\n              \"Fn::Equals\": [\n                {\n                  \"Ref\": \"AWS::Region\"\n                },\n                \"cn-northwest-1\"\n              ]\n            }\n          ]\n        },\n        {\n          \"Fn::Or\": [\n            {\n              \"Fn::Equals\": [\n                {\n                  \"Ref\": \"AWS::Region\"\n                },\n                \"eu-central-1\"\n              ]\n            },\n            {\n              \"Fn::Equals\": [\n                {\n                  \"Ref\": \"AWS::Region\"\n                },\n                \"eu-north-1\"\n              ]\n            },\n            {\n              \"Fn::Equals\": [\n                {\n                  \"Ref\": \"AWS::Region\"\n                },\n                \"eu-south-1\"\n              ]\n            },\n            {\n              \"Fn::Equals\": [\n                {\n                  \"Ref\": \"AWS::Region\"\n                },\n                \"eu-west-1\"\n              ]\n            },\n            {\n              \"Fn::Equals\": [\n                {\n                  \"Ref\": \"AWS::Region\"\n                },\n                \"eu-west-2\"\n              ]\n            },\n            {\n              \"Fn::Equals\": [\n                {\n                  \"Ref\": \"AWS::Region\"\n                },\n                \"eu-west-3\"\n              ]\n            },\n            {\n              \"Fn::Equals\": [\n                {\n                  \"Ref\": \"AWS::Region\"\n                },\n                \"me-south-1\"\n              ]\n            },\n            {\n              \"Fn::Equals\": [\n                {\n                  \"Ref\": \"AWS::Region\"\n                },\n                \"sa-east-1\"\n              ]\n            },\n            {\n              \"Fn::Equals\": [\n                {\n                  \"Ref\": \"AWS::Region\"\n                },\n                \"us-east-1\"\n              ]\n            },\n            {\n              \"Fn::Equals\": [\n                {\n                  \"Ref\": \"AWS::Region\"\n                },\n                \"us-east-2\"\n              ]\n            }\n          ]\n        },\n        {\n          \"Fn::Or\": [\n            {\n              \"Fn::Equals\": [\n                {\n                  \"Ref\": \"AWS::Region\"\n                },\n                \"us-west-1\"\n              ]\n            },\n            {\n              \"Fn::Equals\": [\n                {\n                  \"Ref\": \"AWS::Region\"\n                },\n                \"us-west-2\"\n              ]\n            }\n          ]\n        }\n      ]\n    }\n  },\n  \"Parameters\": {\n    \"BootstrapVersion\": {\n      \"Type\": \"AWS::SSM::Parameter::Value<String>\",\n      \"Default\": \"/cdk-bootstrap/hnb659fds/version\",\n      \"Description\": \"Version of the CDK Bootstrap resources in this environment, automatically retrieved from SSM Parameter Store. [cdk:skip]\"\n    }\n  },\n  \"Rules\": {\n    \"CheckBootstrapVersion\": {\n      \"Assertions\": [\n        {\n          \"Assert\": {\n            \"Fn::Not\": [\n              {\n                \"Fn::Contains\": [\n                  [\n                    \"1\",\n                    \"2\",\n                    \"3\",\n                    \"4\",\n                    \"5\"\n                  ],\n                  {\n                    \"Ref\": \"BootstrapVersion\"\n                  }\n                ]\n              }\n            ]\n          },\n          \"AssertDescription\": \"CDK bootstrap stack version 6 required. Please run 'cdk bootstrap' with a recent version of the CDK CLI.\"\n        }\n      ]\n    }\n  }\n}\n",
        "StagesAvailable": [
            "Original",
            "Processed"
        ],
        "ResponseMetadata": {}
    }
}